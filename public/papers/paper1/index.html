<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Flexible and efficient simulation-based inference for models of decision-making | Jan Boelts (Teusen)</title>
<meta name="keywords" content="machine learning, Bayesian inference, neuroscience, decision-making, SBI">
<meta name="description" content="We introduce Mixed Neural Likelihood Estimation (MNLE), a simulation-based inference method for models with both continuous and discrete data, enabling efficient Bayesian inference in decision-making models.">
<meta name="author" content="Jan Boelts,&thinsp;Jan-Matthis Lueckmann,&thinsp;Richard Gao,&thinsp;Jakob H. Macke">
<link rel="canonical" href="https://janfb.github.io/papers/paper1/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fdef9ee759c868e1e94432f65c96e619da33b8922a9dd5c5e239f740df4826e9.css" integrity="sha256-/e&#43;e51nIaOHpRDL2XJbmGdozuJIqndXF4jn3QN9IJuk=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://janfb.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://janfb.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://janfb.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://janfb.github.io/apple-touch-icon.png">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:title" content="Flexible and efficient simulation-based inference for models of decision-making" />
<meta property="og:description" content="We introduce Mixed Neural Likelihood Estimation (MNLE), a simulation-based inference method for models with both continuous and discrete data, enabling efficient Bayesian inference in decision-making models." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://janfb.github.io/papers/paper1/" />
<meta property="og:image" content="https://janfb.github.io/paper1.jpg" /><meta property="article:section" content="papers" />
<meta property="article:published_time" content="2022-07-27T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-07-12T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://janfb.github.io/paper1.jpg" />
<meta name="twitter:title" content="Flexible and efficient simulation-based inference for models of decision-making"/>
<meta name="twitter:description" content="We introduce Mixed Neural Likelihood Estimation (MNLE), a simulation-based inference method for models with both continuous and discrete data, enabling efficient Bayesian inference in decision-making models."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Papers",
      "item": "https://janfb.github.io/papers/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Flexible and efficient simulation-based inference for models of decision-making",
      "item": "https://janfb.github.io/papers/paper1/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Flexible and efficient simulation-based inference for models of decision-making",
  "name": "Flexible and efficient simulation-based inference for models of decision-making",
  "description": "We introduce Mixed Neural Likelihood Estimation (MNLE), a simulation-based inference method for models with both continuous and discrete data, enabling efficient Bayesian inference in decision-making models.",
  "keywords": [
    "machine learning", "Bayesian inference", "neuroscience", "decision-making", "SBI"
  ],
  "articleBody": " Download Paper Code and data Abstract Inferring parameters of computational models that capture experimental data is a central task in cognitive neuroscience. Bayesian statistical inference methods usually require the ability to evaluate the likelihood of the model—however, for many models of interest in cognitive neuroscience, the associated likelihoods cannot be computed efficiently. Simulation-based inference (SBI) offers a solution to this problem by only requiring access to simulations produced by the model. Previously, Fengler et al. introduced Likelihood Approximation Networks (LAN, Fengler et al., 2021) which make it possible to apply SBI to models of decision-making, but require billions of simulations for training. Here, we provide a new SBI method that is substantially more simulation-efficient. Our approach, Mixed Neural Likelihood Estimation (MNLE), trains neural density estimators on model simulations to emulate the simulator, and is designed to capture both the continuous (e.g., reaction times) and discrete (choices) data of decision-making models. The likelihoods of the emulator can then be used to perform Bayesian parameter inference on experimental data using standard approximate inference methods like Markov Chain Monte Carlo sampling. We demonstrate MNLE on two variants of the drift-diffusion model (DDM) and show that it is substantially more efficient than LANs. MNLE achieves similar likelihood accuracy with six orders of magnitude fewer training simulations, and is significantly more accurate than LANs when both are trained with the same budget. This enables researchers to perform SBI on custom-tailored models of decision-making, leading to fast iteration of model design for scientific discovery.\nBoelts, J., Lueckmann, J. M., Gao, R., \u0026 Macke, J. H. (2022). Flexible and efficient simulation-based inference for models of decision-making. Elife, 11, e77220. https://elifesciences.org/articles/77220 @article{boelts2022flexible, title={Flexible and efficient simulation-based inference for models of decision-making}, author={Boelts, Jan and Lueckmann, Jan-Matthis and Gao, Richard and Macke, Jakob H}, journal={Elife}, volume={11}, pages={e77220}, year={2022}, publisher={eLife Sciences Publications Limited} } ",
  "wordCount" : "304",
  "inLanguage": "en",
  "image":"https://janfb.github.io/paper1.jpg","datePublished": "2022-07-27T00:00:00Z",
  "dateModified": "2024-07-12T00:00:00Z",
  "author":[{
    "@type": "Person",
    "name": "Jan Boelts"
  }, {
    "@type": "Person",
    "name": "Jan-Matthis Lueckmann"
  }, {
    "@type": "Person",
    "name": "Richard Gao"
  }, {
    "@type": "Person",
    "name": "Jakob H. Macke"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://janfb.github.io/papers/paper1/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Jan Boelts (Teusen)",
    "logo": {
      "@type": "ImageObject",
      "url": "https://janfb.github.io/favicon.ico"
    }
  }
}
</script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" integrity="sha384-wcIxkf4k558AjM3Yz3BBFQUbk/zgIYC2R0QpeeYb+TwlBVMrlgLqwRjRtGZiK7ww" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js" integrity="sha384-hIoBPJpTUs74ddyc4bFZSM1TVlQDA60VBbJS0oA934VSz82sBx1X7kSx2ATBDIyd" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous"
  onload="renderMathInElement(document.body);"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          delimiters: [
            {left: '$$', right: '$$', display: true},
            {left: '$', right: '$', display: false},
            {left: "\\begin{equation}", right: "\\end{equation}", display: true},
            {left: "\\begin{equation*}", right: "\\end{equation*}", display: true},
            {left: "\\begin{align}", right: "\\end{align}", display: true},
            {left: "\\begin{align*}", right: "\\end{align*}", display: true},
            {left: "\\begin{alignat}", right: "\\end{alignat}", display: true},
            {left: "\\begin{gather}", right: "\\end{gather}", display: true},
            {left: "\\begin{CD}", right: "\\end{CD}", display: true},
          ],
          throwOnError : false
        });
    });
</script>
 


</head>

<body class="" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://janfb.github.io" accesskey="h" title="Jan Boelts (Teusen)">
                <img src="https://janfb.github.io/favicon.ico" alt="" aria-label="logo"
                    height="18"
                    width="18">Jan Boelts (Teusen)</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://janfb.github.io/papers/" title="Papers">
                    <span>Papers</span>
                </a>
            </li>
            <li>
                <a href="https://janfb.github.io/talks/" title="Talks">
                    <span>Talks</span>
                </a>
            </li>
            <li>
                <a href="https://janfb.github.io/courses/" title="Courses">
                    <span>Courses</span>
                </a>
            </li>
            <li>
                <a href="https://janfb.github.io/software/" title="Software">
                    <span>Software</span>
                </a>
            </li>
            <li>
                <a href="https://janfb.github.io/data/" title="Data">
                    <span>Data</span>
                </a>
            </li>
            <li>
                <a href="https://janfb.github.io/books/" title="Books">
                    <span>Books</span>
                </a>
            </li>
            <li>
                <a href="https://en.wikipedia.org/wiki/Moritz-Maria_von_Igelfeld_%28character%29" title="Blog">
                    <span>Blog</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>

    <main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Flexible and efficient simulation-based inference for models of decision-making
    </h1>
    <div class="post-meta"><span title='2022-07-27 00:00:00 +0000 UTC'>July 2022</span>&nbsp;&middot;&nbsp;Jan Boelts,&thinsp;Jan-Matthis Lueckmann,&thinsp;Richard Gao,&thinsp;Jakob H. Macke&nbsp;&middot;&nbsp;<a href="https://github.com/pmichaillat/hugo-website" rel="noopener noreferrer" target="_blank">eLife</a>

</div>
  </header> 
  <div class="post-content"><hr>
<h5 id="download">Download</h5>
<ul>
<li><a href="paper1.pdf">Paper</a>
</li>
<li><a href="https://github.com/mackelab/mnle-for-ddms" target="_blank">Code and data</a>
</li>
</ul>
<hr>
<h5 id="abstract">Abstract</h5>
<p>Inferring parameters of computational models that capture experimental data is a central task in cognitive neuroscience. Bayesian statistical inference methods usually require the ability to evaluate the likelihood of the model—however, for many models of interest in cognitive neuroscience, the associated likelihoods cannot be computed efficiently. Simulation-based inference (SBI) offers a solution to this problem by only requiring access to simulations produced by the model. Previously, Fengler et al. introduced Likelihood Approximation Networks (LAN, Fengler et al., 2021) which make it possible to apply SBI to models of decision-making, but require billions of simulations for training. Here, we provide a new SBI method that is substantially more simulation-efficient. Our approach, Mixed Neural Likelihood Estimation (MNLE), trains neural density estimators on model simulations to emulate the simulator, and is designed to capture both the continuous (e.g., reaction times) and discrete (choices) data of decision-making models. The likelihoods of the emulator can then be used to perform Bayesian parameter inference on experimental data using standard approximate inference methods like Markov Chain Monte Carlo sampling. We demonstrate MNLE on two variants of the drift-diffusion model (DDM) and show that it is substantially more efficient than LANs. MNLE achieves similar likelihood accuracy with six orders of magnitude fewer training simulations, and is significantly more accurate than LANs when both are trained with the same budget. This enables researchers to perform SBI on custom-tailored models of decision-making, leading to fast iteration of model design for scientific discovery.</p>
<p>Boelts, J., Lueckmann, J. M., Gao, R., &amp; Macke, J. H. (2022). Flexible and efficient
simulation-based inference for models of decision-making. Elife, 11, e77220. <a href="https://elifesciences.org/articles/77220" target="_blank">https://elifesciences.org/articles/77220</a>
</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-BibTeX" data-lang="BibTeX"><span style="display:flex;"><span><span style="color:#0a0;text-decoration:underline">@article</span>{boelts2022flexible,
</span></span><span style="display:flex;"><span>  <span style="color:#1e90ff">title</span>=<span style="color:#a50">{Flexible and efficient simulation-based inference for models of decision-making}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#1e90ff">author</span>=<span style="color:#a50">{Boelts, Jan and Lueckmann, Jan-Matthis and Gao, Richard and Macke, Jakob H}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#1e90ff">journal</span>=<span style="color:#a50">{Elife}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#1e90ff">volume</span>=<span style="color:#a50">{11}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#1e90ff">pages</span>=<span style="color:#a50">{e77220}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#1e90ff">year</span>=<span style="color:#a50">{2022}</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#1e90ff">publisher</span>=<span style="color:#a50">{eLife Sciences Publications Limited}</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://janfb.github.io/tags/machine-learning/">machine learning</a></li>
      <li><a href="https://janfb.github.io/tags/bayesian-inference/">Bayesian inference</a></li>
      <li><a href="https://janfb.github.io/tags/neuroscience/">neuroscience</a></li>
      <li><a href="https://janfb.github.io/tags/decision-making/">decision-making</a></li>
      <li><a href="https://janfb.github.io/tags/sbi/">SBI</a></li>
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="https://janfb.github.io">Jan Boelts (Teusen)</a></span> ·     
    <span>
    Powered by 
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/pmichaillat/hugo-website/" rel="noopener" target="_blank">a modified version</a>
         of 
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>
</html>
